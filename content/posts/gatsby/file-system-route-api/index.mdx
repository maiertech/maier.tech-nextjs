---
title: What you need to know about the File System Route API in Gatsby
author: thilo
date: 2021-03-27
description:
  Last November Gatsby released the File System Route API as an alternative to
  the Gatsby Node APIs to generate pages programmatically. For anyone familiar
  with dynamic routes in Next.js, the File System Route API contains no
  surprises. After reading this post you will have a better idea how the File
  System Route API can replace or complement a gatsby-node.js file for
  programmatic page generation.
tags:
  - gatsby
---

The new
[File System Route API](https://www.gatsbyjs.com/docs/reference/routing/file-system-route-api/)
in Gatsby takes inspiration from
[dynamic routes in Next.js](https://nextjs.org/docs/routing/dynamic-routes). The
main difference is that the File System API retrieves data from Gatsby's GraphQL
layer, while in Next.js for dynamic routes you have to write custom code to
retrieve data from any data source that can be tapped with JavaScript.

[Gatsby Node APIs](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/)
used to be the only way to generate pages programamtically inside a
`gatsby-node.js`. You can think of Node APIs as a collection of hooks with which
you can hook into Gatsby's build process to manipulate nodes in Gatsby's GraphQL
layer and to generate pages programamtically. In my
[Gatsby themes](https://github.com/maiertech/gatsby-themes) I tend to create the
following API functions in `gatsby-node.js`:

- [`onCreateNode`](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#onCreateNode)
  is called when a new node is created. You can use this function to derive new
  nodes from existing nodes or to add fields to existing nodes.
- [`createPages`](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#createPages)
  is called after the GraphQL layer is ready. You can query nodes and then
  create pages from queried nodes.
- [`createSchemaCustomization`](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#createSchemaCustomization)
  is called to override Gatsby's
  [schema inference](https://www.gatsbyjs.com/docs/schema-inference/). This is
  called
  [schema customization](https://www.gatsbyjs.com/docs/reference/graphql-data-layer/schema-customization/).
  You do not have to customize your GraphQL schema. Schema inference is robust
  and works well. In my Gatbsy themes I customize the schema and introduce
  custom types to simplify GraphQL queries.

A typical sequence for programmatic page generation looks like this:

1. Source nodes from various data sources.
1. Transform nodes and derive new nodes.
1. Generate pages from a subset of nodes.

This involves two types of GraphQL queries:

1. A **node selection query** to select nodes from which pages should be
   generated (executed inside `createPages`).
1. A **page query** exported from a template and run during page generation.

The File System Route API does not make the Gatsby Node APIs and
`gatsby-node.js` obsolete. It is an alterantive API for programmatic page
generation that complements Gatsby Node APIs and can replace it in certain
scenarios. With the File System Route API, you trade in full control and
complexity for a more simple but more opinionated approach that covers many
common scenarios, but not all.

Before we dive into the File System Route API, let us recall that directory
[`src/pages` has special routing powers in Gatsby](https://www.gatsbyjs.com/docs/reference/routing/creating-routes/#routes-defined-in-srcpages).
Any React component in this directory is turned into a page whose route
corresponds to the file path.

## Collection routes (`{}` notation)

The File System Route API allows you to place React components in `src/pages`
that have additional information encoded in their filename and/or pathname.
Component `src/pages/posts/{Post.title}.js` with `{}` notation in the filename
triggers page generation for each GraphQL `Post` node. `{Post.title}` is
interpreted as node selection query to select a collection of nodes from which
to create pages. In this example Gatsby creates this query under the hood

```graphql
allPost {
  nodes {
    id
    title
  }
}
```

and generates a page for each `id` using the default export of file
`{Post.title}.js`, which also has to export a page query that receives `id` as
query parameter.

As a convention, the queried value, `Post.title` is
[slugified](https://github.com/sindresorhus/slugify) and only then used as part
of the route. For example, title **What you need to know about the File System
Route API in Gatsby** would result in route
`/posts/what-you-need-to-know-about-the-file-system-route-api-in-gatsby/`.

## Client-only routes (`[]` notation)

You can also use `[]` notation with the File System Route API to create
client-only routes. This corresponds to dynamic routes in Next.js. For example,
file `src/pages/users/[id].js` results in client-only routes following this
pattern: `/users/:id`. `:id` is the
[route paramters notation from Express](https://expressjs.com/en/guide/routing.html).
A `params` object with prop `id` is passed into the React component availalbe as
default export in file `[id].js`.

A common use case for `[]` notation in Gatsby is a fallback for a collection
route. For example, you could complement `src/pages/products/{Product.name}.js`
with `src/pages/products/[name].js`. In this scneario, the collection route
takes precedence and for everything else the client-only route is used.

## Catch all

With the File System Route API you can use `[]` notation to create a catch all
route and delegate all routes in a subtree of your site to an app. For example,
`/src/pages/dashboard/[...].js` will handle all `/dashboard/*` routes. You can
access sub-routes like this

```jsx
function App(props) {
  const splat = props.params[‘*’]
}
```

and pass them into a router, if your app uses one.

## Conclusion

The new File System Route API in Gatby does not make the existing Node APIs and
`gatsby-node.js` obsolete. Rather, the new API complements the existing API and
can replace it in some scenarios. `[]` notation adds an API that is similar to
dynamic routes in Next.js. `{}` notation adapts dynamic routes to Gatsby's
GraphQL layer, which is Gatsby's unique selling point to access data from
various data sources. There are more types of GraphQL queries that can be
expressed with `{}` notation than covered in this post. Therefore, you should
still check out the
[File System Route API documentation](https://www.gatsbyjs.com/docs/reference/routing/file-system-route-api/).
